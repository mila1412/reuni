(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{"2ff9":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"row justify-center items-center",attrs:{id:"profile"}},[n("div",{staticClass:"column q-pa-lg"},[n("div",{staticClass:"row"},[n("q-card",{staticStyle:{width:"300px",height:"500px"},attrs:{square:""}},[n("q-card-section",{staticClass:"bg-brand text-center"},[n("h4",{staticClass:"text-h6 text-white"},[t._v("修改會員資料")])]),n("q-card-section",[n("q-form",{staticClass:"q-px-sm",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[n("q-input",{attrs:{square:"",clearable:"",label:"請輸入帳號",rules:[function(e){return t.$v.account.required||"請輸入帳號"},function(e){return t.$v.account.minLength||"最少 4 個字元"},function(e){return t.$v.account.maxLength||"最多 16 個字元"}]},on:{input:function(e){return t.$v.account.$touch()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"person"}})]},proxy:!0}]),model:{value:t.account,callback:function(e){t.account="string"===typeof e?e.trim():e},expression:"account"}}),n("q-input",{attrs:{square:"",clearable:"",type:t.isPwd?"password":"text",label:"請輸入密碼",rules:[function(e){return t.$v.password.required||"請輸入密碼"},function(e){return t.$v.password.minLength||"最少 4 個字元"},function(e){return t.$v.password.maxLength||"最多 16 個字元"}]},on:{input:function(e){return t.$v.password.$touch()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"lock"}})]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:t.isPwd?"visibility_off":"visibility"},on:{click:function(e){t.isPwd=!t.isPwd}}})]},proxy:!0}]),model:{value:t.password,callback:function(e){t.password="string"===typeof e?e.trim():e},expression:"password"}}),n("q-input",{attrs:{square:"",clearable:"",type:t.isPwd?"password":"text",label:"請再次輸入密碼",rules:[function(e){return t.$v.password.required||"請輸入密碼"},function(e){return e===t.password||"輸入密碼不一致"}]},on:{input:function(e){return t.$v.password.$touch()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"lock"}})]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:t.isPwd?"visibility_off":"visibility"},on:{click:function(e){t.isPwd=!t.isPwd}}})]},proxy:!0}]),model:{value:t.password2,callback:function(e){t.password2="string"===typeof e?e.trim():e},expression:"password2"}}),n("q-input",{attrs:{square:"",clearable:"",type:"email",label:"請輸入信箱",rules:[function(e){return t.$v.email.required||"請輸入信箱"},function(e){return t.$v.email.email||"信箱格式不符"}]},on:{input:function(e){return t.$v.email.$touch()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"email"}})]},proxy:!0}]),model:{value:t.email,callback:function(e){t.email="string"===typeof e?e.trim():e},expression:"email"}}),n("div",{staticClass:"q-pt-lg"},[n("q-btn",{staticClass:"full-width bg-brand text-white",attrs:{unelevated:"",size:"lg",label:"確認修改",type:"submit"}})],1)],1)],1)],1)],1)])])},s=[],a=n("c973"),o=n.n(a),i=(n("96cf"),n("6821")),u=n.n(i),c=n("b5ae"),l={name:"PageProfile",data:function(){return{account:this.$store.state.user.user.account,email:this.$store.state.user.user.email,password:"",password2:"",isPwd:!0}},computed:{userAccount:function(){return this.$store.state.user.user.account},userEmail:function(){return this.$store.state.user.user.email}},validations:{account:{required:c["required"],minLength:Object(c["minLength"])(4),maxLength:Object(c["maxLength"])(16)},password:{required:c["required"],minLength:Object(c["minLength"])(4),maxLength:Object(c["maxLength"])(16)},email:{required:c["required"],email:c["email"]}},methods:{submit:function(){var t=this;return o()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.patch("/users",{account:t.account,password:u()(t.password),email:t.email},{headers:{authorization:"Bearer "+t.$store.state.user.jwt.token}});case 3:t.logout(),t.$router.push("/login"),t.$q.notify({message:"請重新登入",timeout:1e3,type:"warning",color:"faded",textColor:"white",position:"top"}),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0),t.$q.notify({message:e.t0.response.data.message,timeout:1e3,type:"negative",color:"faded",textColor:"white",position:"top"});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()},logout:function(){var t=this;return o()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.delete("/users/logout",{headers:{authorization:"Bearer "+t.$store.state.user.jwt.token}});case 3:t.$store.commit("user/cartBeforeLogout"),t.$store.commit("user/logout"),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),t.$q.notify({message:"發生錯誤",timeout:1e3,type:"negative",color:"faded",textColor:"white",position:"top"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}},p=l,d=n("2877"),m=n("9989"),f=n("f09f"),w=n("a370"),h=n("0378"),g=n("27f9"),v=n("0016"),b=n("9c40"),q=n("eebe"),x=n.n(q),y=Object(d["a"])(p,r,s,!1,null,null,null);e["default"]=y.exports;x()(y,"components",{QPage:m["a"],QCard:f["a"],QCardSection:w["a"],QForm:h["a"],QInput:g["a"],QIcon:v["a"],QBtn:b["a"]})}}]);